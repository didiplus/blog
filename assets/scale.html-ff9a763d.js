import{ab as r,G as u,H as p,N as s,E as n,S as e,ac as l,ad as d,W as a}from"./framework-894cff3a.js";const k={},b=n("h1",{id:"_2-4、伸缩应用程序",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-4、伸缩应用程序","aria-hidden":"true"},"#"),e(" 2.4、伸缩应用程序")],-1),m={href:"https://kubernetes.io/docs/tutorials/kubernetes-basics/scale/scale-intro/",target:"_blank",rel:"noopener noreferrer"},h=n("h2",{id:"目标",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#目标","aria-hidden":"true"},"#"),e(" 目标")],-1),g=n("ul",null,[n("li",null,"使用 kubectl 伸缩应用程序。")],-1),_=n("h2",{id:"scaling-伸缩-应用程序",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#scaling-伸缩-应用程序","aria-hidden":"true"},"#"),e(" Scaling（伸缩）应用程序")],-1),v={href:"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/",target:"_blank",rel:"noopener noreferrer"},y={href:"https://kubernetes.io/docs/concepts/services-networking/service/",target:"_blank",rel:"noopener noreferrer"},f=d(`<p><strong>伸缩</strong> 的实现可以通过更改<code>nginx-deployment.yaml</code>文件中部署的<strong>replicas</strong>（副本数）来完成</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>    <span class="token comment">#使用该Deployment创建两个应用程序实例</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="scaling-伸缩-概述" tabindex="-1"><a class="header-anchor" href="#scaling-伸缩-概述" aria-hidden="true">#</a> Scaling（伸缩）概述</h2><p>下图中，Service A 只将访问流量转发到 IP 为 10.0.0.5 的Pod上</p><figure><img src="https://kuboard.cn/assets/img/module_05_scaling1.d9d22450.svg" alt="Kubernetes教程：伸缩" tabindex="0" loading="lazy"><figcaption>Kubernetes教程：伸缩</figcaption></figure><p>修改了 Deployment 的 replicas 为 4 后，Kubernetes 又为该 Deployment 创建了 3 新的 Pod，这 4 个 Pod 有相同的标签。因此Service A通过标签选择器与新的 Pod建立了对应关系，将访问流量通过负载均衡在 4 个 Pod 之间进行转发。</p><figure><img src="https://kuboard.cn/assets/img/module_05_scaling2.3f74dfba.svg" alt="Kubernetes教程：伸缩" tabindex="0" loading="lazy"><figcaption>Kubernetes教程：伸缩</figcaption></figure><div class="hint-container tip"><p class="hint-container-title">提示</p><p>通过更改部署中的 replicas（副本数）来完成扩展</p></div><h2 id="实战-将-nginx-deployment-扩容到-4-个副本" tabindex="-1"><a class="header-anchor" href="#实战-将-nginx-deployment-扩容到-4-个副本" aria-hidden="true">#</a> 实战：将 nginx Deployment 扩容到 4 个副本</h2>`,9),x=n("p",null,[n("strong",null,"修改 nginx-deployment.yaml 文件")],-1),P=n("div",{class:"language-yaml line-numbers-mode","data-ext":"yml"},[n("pre",{class:"language-yaml"},[n("code",null,[n("span",{class:"token key atrule"},"apiVersion"),n("span",{class:"token punctuation"},":"),e(` apps/v1
`),n("span",{class:"token key atrule"},"kind"),n("span",{class:"token punctuation"},":"),e(` Deployment
`),n("span",{class:"token key atrule"},"metadata"),n("span",{class:"token punctuation"},":"),e(`
  `),n("span",{class:"token key atrule"},"name"),n("span",{class:"token punctuation"},":"),e(" nginx"),n("span",{class:"token punctuation"},"-"),e(`deployment
  `),n("span",{class:"token key atrule"},"labels"),n("span",{class:"token punctuation"},":"),e(`
    `),n("span",{class:"token key atrule"},"app"),n("span",{class:"token punctuation"},":"),e(` nginx
`),n("span",{class:"token key atrule"},"spec"),n("span",{class:"token punctuation"},":"),e(`
  `),n("span",{class:"token key atrule"},"replicas"),n("span",{class:"token punctuation"},":"),e(),n("span",{class:"token number"},"4"),e(`
  `),n("span",{class:"token key atrule"},"selector"),n("span",{class:"token punctuation"},":"),e(`
    `),n("span",{class:"token key atrule"},"matchLabels"),n("span",{class:"token punctuation"},":"),e(`
      `),n("span",{class:"token key atrule"},"app"),n("span",{class:"token punctuation"},":"),e(` nginx
  `),n("span",{class:"token key atrule"},"template"),n("span",{class:"token punctuation"},":"),e(`
    `),n("span",{class:"token key atrule"},"metadata"),n("span",{class:"token punctuation"},":"),e(`
      `),n("span",{class:"token key atrule"},"labels"),n("span",{class:"token punctuation"},":"),e(`
        `),n("span",{class:"token key atrule"},"app"),n("span",{class:"token punctuation"},":"),e(` nginx
    `),n("span",{class:"token key atrule"},"spec"),n("span",{class:"token punctuation"},":"),e(`
      `),n("span",{class:"token key atrule"},"containers"),n("span",{class:"token punctuation"},":"),e(`
      `),n("span",{class:"token punctuation"},"-"),e(),n("span",{class:"token key atrule"},"name"),n("span",{class:"token punctuation"},":"),e(` nginx
        `),n("span",{class:"token key atrule"},"image"),n("span",{class:"token punctuation"},":"),e(" nginx"),n("span",{class:"token punctuation"},":"),e(`1.7.9
        `),n("span",{class:"token key atrule"},"ports"),n("span",{class:"token punctuation"},":"),e(`
        `),n("span",{class:"token punctuation"},"-"),e(),n("span",{class:"token key atrule"},"containerPort"),n("span",{class:"token punctuation"},":"),e(),n("span",{class:"token number"},"80"),e(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"}," "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),S=n("p",null,[n("strong",null,"执行命令")],-1),D=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[e("kubectl apply "),n("span",{class:"token parameter variable"},"-f"),e(` nginx-deployment.yaml
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),A=n("p",null,[n("strong",null,"查看结果")],-1),K=n("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token function"},"watch"),e(" kubectl get pods "),n("span",{class:"token parameter variable"},"-o"),e(` wide
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),w=n("p",null,"~~一旦运行了多个应用程序实例，就可以在不停机的情况下执行滚动更新了，",-1);function L(N,T){const i=a("AdSenseTitle"),t=a("ExternalLinkIcon"),c=a("Tabs"),o=a("RouterLink");return u(),p("div",null,[b,s(i),n("p",null,[e("本文翻译自 Kubernetes "),n("a",m,[e("Running Multiple Instances of Your App"),s(t)]),e(" ，并有所改写")]),h,g,_,n("p",null,[e("在之前的文章中，我们创建了一个 "),n("a",v,[e("Deployment"),s(t)]),e("，然后通过 "),n("a",y,[e("服务"),s(t)]),e(" 提供访问 Pod 的方式。我们发布的 Deployment 只创建了一个 Pod 来运行我们的应用程序。当流量增加时，我们需要对应用程序进行伸缩操作以满足系统性能需求。")]),f,s(c,{id:"51",data:[{title:"使用kubectl"}],active:0},{tab0:l(({title:V,value:E,isActive:I})=>[x,P,S,D,A,K]),_:1}),w,n("p",null,[e("~~let‘s go-> "),s(o,{to:"/cloud/k8s/k8s-basics/update.html"},{default:l(()=>[e("执行滚动更新")]),_:1})])])}const R=r(k,[["render",L],["__file","scale.html.vue"]]);export{R as default};
