# 01 é˜²ç«å¢™è®¾å¤‡çš„ç™»å½•é…ç½®


å˜¿ï¼Œäº²çˆ±çš„ç§‘æŠ€å†’é™©å®¶ä»¬ï¼ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä¸€åŒæ­å¼€æ•°å­—ä¸–ç•Œçš„ç¥ç§˜é¢çº±ï¼Œæ¢ç´¢é‚£ä¸ªä¿å«æˆ‘ä»¬ç½‘ç»œå®‰å…¨çš„æ— åè‹±é›„â€”â€”é˜²ç«å¢™ï¼ğŸ›¡ï¸

é¦–å…ˆï¼Œä½ å¾—çŸ¥é“ï¼Œé˜²ç«å¢™å°±åƒæ˜¯æˆ‘ä»¬æ•°å­—é¢†åŸŸçš„ä¸€ä½åšå®çš„å®ˆæŠ¤è€…ï¼Œè´Ÿè´£ä¿æŠ¤æˆ‘ä»¬çš„æ•°æ®å…å—ä¸é€Ÿä¹‹å®¢çš„ä¾µå®³ã€‚è€Œä¸ºäº†ä¸è¿™ä½å®ˆæŠ¤è€…äº¤æµï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€å®ƒçš„å¤§é—¨ï¼Œä¹Ÿå°±æ˜¯ç™»å½•é…ç½®ã€‚ç°åœ¨ï¼Œå°±è·Ÿæˆ‘ä¸€èµ·æ¥æ¢é™©å§ï¼


## ğŸ”ç¬¬ä¸€æ­¥ï¼šæ­å»ºå®éªŒæ‹“æ‰‘

æœ¬æ¡ˆä¾‹ä¸­ä½¿ç”¨åä¸ºæ¨¡æ‹Ÿå™¨ENSPï¼Œå¦‚ä¸‹å›¾ï¼ŒæŠŠå®éªŒæ‹“æ‰‘æ­å»ºå®Œæˆã€‚


![å®éªŒæ‹“æ‰‘](https://didiplus.oss-cn-hangzhou.aliyuncs.com/20240111214648.png)

## ğŸ”‘ç¬¬äºŒæ­¥ï¼šå®éªŒè®²è§£

æœ¬ä¸“æ ä¸€å…±è§„åˆ’ä¸º8ä¸ªå°ç‚¹ï¼Œæ¯ä¸€ä¸ªå°ç‚¹åˆ†åˆ«æ˜¯ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

1ã€é…ç½®é˜²ç«å¢™è®¾å¤‡SSH ä¸WEBç™»å½• ï¼Œç™»å½•è´¦å·ä¸ºUSER/Huawei@123

2ã€é˜²ç«å¢™å®‰å…¨åŒºåŸŸä¸å®‰å…¨ç­–ç•¥

3ã€éªŒè¯é˜²ç«å¢™ASPF

4ã€å¸¸è§æœåŠ¡å™¨DHCPä¸PPPoEéƒ¨ç½²

5ã€éƒ¨ç½²é˜²ç«å¢™å¸¸è§NATæŠ€æœ¯

6ã€é˜²ç«å¢™æœ¬åœ°Portaléƒ¨ç½²

7ã€é˜²ç«å¢™å†…å®¹å®‰å…¨

8ã€é˜²æŠ¤æœŸæ”»å‡»é˜²èŒƒ

ä»Šå¤©æ˜¯å®Œæˆç¬¬1ä¸ªçŸ¥è¯†ç‚¹ï¼š`é…ç½®é˜²ç«å¢™è®¾å¤‡SSH ä¸WEBç™»å½• ï¼Œç™»å½•è´¦å·ä¸ºUSER/Huawei@123`


## ğŸš€ç¬¬ä¸‰æ­¥ï¼šå¼€å§‹å®éªŒ

æœ¬ç« ä¸»è¦ç”¨åˆ°è®¾å¤‡æ˜¯`Local`ã€`AR1` ä¸ `FW2`ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸‰å°è®¾å¤‡å¯åŠ¨å³å¯ã€‚å¯åŠ¨å®Œå¹¶æŠŠå¯¹åº”çš„æ¥å£çš„IPåœ°å€è¿›è¡Œé…ç½®ï¼Œå¹¶æŠŠå¯¹æ¥çš„æ¥å£åŠ å…¥ç›¸åº”çš„å®‰å…¨åŸŸ

é˜²ç«å¢™ä¸è·¯ç”±å™¨å…¶ä¸­æœ€å¤§åŒºåˆ«åœ¨äºäºå®‰å…¨åŸŸçš„æ¦‚å¿µï¼Œé‚£ä»€ä¹ˆæ˜¯å®‰å…¨åŸŸï¼Ÿ

> é˜²ç«å¢™å®‰å…¨åŸŸæ˜¯æŒ‡åœ¨ç½‘ç»œä¸­ï¼Œç”±é˜²ç«å¢™ä¿æŠ¤çš„ç‰¹å®šåŒºåŸŸæˆ–ç½‘ç»œæ®µï¼Œå…¶ä¸­çš„è®¾å¤‡å’Œé€šä¿¡å—åˆ°é˜²ç«å¢™çš„ç®¡ç†å’Œç›‘æ§ã€‚é˜²ç«å¢™é€šå¸¸ç”¨äºåˆ’å®šä¸åŒçš„å®‰å…¨åŸŸï¼Œä»¥æ§åˆ¶æ•°æ®æµé‡å’Œç¡®ä¿ç½‘ç»œå®‰å…¨ã€‚åœ¨é˜²ç«å¢™å®‰å…¨åŸŸå†…ï¼Œç®¡ç†å‘˜å¯ä»¥å®šä¹‰è®¿é—®è§„åˆ™ã€ç›‘æ§æµé‡ã€æ‰§è¡Œå®‰å…¨ç­–ç•¥ï¼Œä»¥ä¿æŠ¤ç½‘ç»œå…å—æœªç»æˆæƒçš„è®¿é—®æˆ–æ¶æ„æ´»åŠ¨çš„å½±å“ã€‚

åä¸ºé˜²ç«å¢™é»˜è®¤æƒ…å†µä¸‹å·²ç»è§„åˆ’äº†å››ä¸ªåŒºåŸŸ

- Unturst
- Turst
- DMZ
- Local



1. é…ç½®é˜²ç«å¢™G0/0/0æ¥å£çš„IPåœ°å€å’ŒAR1è·¯ç”±çš„GE0/0/0æ¥å£IPåœ°å€
   
```bash
# é˜²ç«å¢™ä¸Šé…ç½®G0/0/0å£
interface GigabitEthernet0/0/0
 undo shutdown
 ip binding vpn-instance default
 ip address 192.168.43.10 255.255.255.0
 alias GE0/METH
 service-manage https permit
 service-manage ssh permit
 service-manage ping permit
```
> åä¸ºé˜²ç«å¢™é»˜è®¤æƒ…å†µä¸‹G0/0/0æ˜¯è§„åˆ’æˆç®¡ç†æ¥å£çš„

å®Œæˆä¸Šè¿°é…ç½®ä¹‹åï¼Œå°±å¯ä»¥åœ¨ç‰©ç†æœºä¸Šé€šè¿‡`https://192.168.43.10:8443`è®¿é—®åˆ°é˜²ç«å¢™çš„ç®¡ç†é¡µé¢ï¼Œå¦‚å›¾ä¸‹å›¾ï¼š

![é˜²ç«å¢™ç™»å½•ç•Œé¢](https://didiplus.oss-cn-hangzhou.aliyuncs.com/20240112091646.png)

2. ä¸ºé˜²ç«å¢™æ–°å»ºç”¨æˆ·ï¼Œå¹¶èµ‹äºˆç®¡ç†å‘˜çš„æƒé™

```bash
 manager-user USER
  password cipher Huawei@123
  service-type web ssh
bind manager-user USER role system-admin
```

> åˆ›å»ºä¸€ä¸ªåä¸ºUSERçš„ç”¨æˆ·ï¼Œè®¾ç½®å¯†ç ä¸º`Huawei@123`,å¹¶ç»‘å®šä¸ºç®¡ç†å‘˜è§’è‰²

3. é€šè¿‡USERç”¨æˆ·ï¼Œè¿›è¡Œç®¡ç†é˜²ç«å¢™ã€‚å¦‚ä¸‹å›¾ï¼š

![ç™»å½•åçš„é˜²ç«å¢™](https://didiplus.oss-cn-hangzhou.aliyuncs.com/20240112093011.png)

4. æ¿€æ´»SSH

é€šè¿‡æ‰§è¡Œ`stelnet server  enable`å‘½ä»¤æ¿€æ´»sshæœåŠ¡ã€‚
```bash
[FW1]stelnet server  enable 
Info: Succeeded in starting the Stelnet server
```

5. è®¾ç½®SSHç™»å½•ç±»å‹ï¼Œé‡‡ç”¨å¯†ç ç™»å½•ã€‚
   
```bash
[FW1]ssh user  USER authentication-type password 
Info: Succeeded in adding a new SSH user.
[FW1]ssh user USER service-type stelnet
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå·²ç»æ¿€æ´»äº†
```bash
[FW1-ui-vty0-4]display this 
2024-01-12 01:41:09.300 
#
user-interface con 0
 authentication-mode aaa
user-interface vty 0 4
 authentication-mode aaa
 protocol inbound ssh
user-interface vty 16 20
```

å®Œæˆä¸Šè¿°é…ç½®åï¼Œå³å¯ä»æœ¬æœºé€šè¿‡sshç™»å½•åˆ°é˜²ç«å¢™ä¸Šï¼Œå¦‚ä¸‹å›¾ï¼š

![](https://didiplus.oss-cn-hangzhou.aliyuncs.com/20240112093638.png)

![](https://didiplus.oss-cn-hangzhou.aliyuncs.com/20240112093857.png)


> æ³¨æ„ï¼š
> æ¨¡æ‹Ÿå™¨æœ‰ä¸ªbugï¼Œå¦‚æœä½ æ˜¯ä»æ¨¡æ‹Ÿå™¨çš„è·¯ç”±å™¨ç™»å½•é˜²ç«å¢™ï¼Œéœ€è¦ä¿®æ”¹sshçš„ç®—æ³•ä¸º`aes128_cbc`
```
[FW1]ssh server compatible-ssh1x
[FW1]ssh server cipher ?
  3des_cbc    3DES encryption algorithm in CBC mode
  aes128_cbc  AES128 encryption algorithm in CBC mode
  aes128_ctr  AES128 encryption algorithm in CTR mode
  aes256_cbc  AES256 encryption algorithm in CBC mode
  aes256_ctr  AES256 encryption algorithm in CTR mode, and this algorithm is
              recommended
  des_cbc     DES encryption algorithm in CBC mode

[FW1]ssh server cipher 
```